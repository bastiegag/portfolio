import { useId } from 'react';
import { styled, useTheme } from '@mui/material';
import { useTranslation } from 'react-i18next';

import { Link } from '@features/navigation';
import { useParallax } from '@shared/hooks/parallax/useParallax';
import { useSettings } from '@features/settings';
import type { PositionedWithModifier } from '@shared/types';

const WIDTH = 39;
const HEIGHT = 25;

export interface MapProps extends PositionedWithModifier {
	scale: number;
}

const MapRoot = styled('g', {
	name: 'Map',
	slot: 'root',
})<{ 'data-night': boolean }>(({ theme, 'data-night': isNight }) => ({
	'.action': {
		transition: 'all 0.3s ease-out !important',
	},
	'&:hover .action': {
		transform: 'rotate(-4px)',
	},
	'.x, .spot': {
		...(isNight && {
			filter: `drop-shadow(0 0 3px ${theme.vars.palette.paper.icon})`,
		}),
	},
}));

export const Map = ({ x, y, modifier, scale }: MapProps) => {
	const { t } = useTranslation();
	const id = CSS.escape(useId());
	const { settings } = useSettings();
	const colors = useTheme().vars.palette;

	useParallax(`#${id}`, x, y, modifier);

	return (
		<Link to="/about" title={t('menu.about')} tab={false}>
			<MapRoot
				id={id}
				className="Map-root link animate-all"
				data-night={settings.time === 'night'}
				transform={`translate(${x},${y})`}
				strokeWidth="0"
			>
				<svg
					width={scale ? WIDTH * scale : WIDTH}
					height={scale ? HEIGHT * scale : HEIGHT}
					viewBox={`0 0 ${WIDTH} ${HEIGHT}`}
				>
					<path
						className="main"
						fill={colors.paper.light}
						d="M33.7,8.3c1.1.2,2.4.6,3.9.9v.6c.1,0,.2.6.2.6h-.9c0-.1,0,.3,0,.3v.2s.6.3,1.6,1.2l-.4,1.2-.2.5,1.1,1.1-.4.5s-1-.3-1.5-.4c-.2,0-.2,0-.1.2.1.3.7.8.7.8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0-.1.1,0,0,0,0,0,0-.3.2-.7.6-1.1,1,0,0,0,0,0,0-.1,0-.2.2-.3.3,0,0,0,0,0,0,0,0-.1.1-.2.2,0,0,0,0,0,0-.1.1-.3.3-.4.4,0,0,0,0-.1.1-.2.1-.3.3-.5.4,0,0-.2.1-.2.2,0,0-.1.1-.2.2,0,0,0,0,0,0-.1.1-.3.2-.4.3,0,0-.1.1-.2.2,0,0-.1,0-.2.1,0,0,0,0,0,0,0,0-.2.1-.3.2,0,0,0,0,0,0-.2.1-.3.3-.5.4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0-.1.1-.2.2-.3.3-.5.5h0c-.7.7-1.2,1.6-1.4,2,0,.2-.1.3-.1.3,0,0,0,0,0,0l-7.5,1.2s-2.8-1.1-6.1-2.6h.1c0,0,0,0,0,0,0,0,0,0,0,0,0-.2-.1-1-.2-1.7,0,0,0,0,0,0,0-.5-.2-1-.2-1,0,0-.2.1-.3.4,0,.1-.1.2-.2.4,0,0,0,0,0,0-.3.5-.6,1.1-.7,1.3,0,0,0,0,0,0h0c-3.2-1.4-6.5-3-8.2-4.2h0s-.1,0-.1,0h0s0,0,0,0l-5.8-.6s4.2-4.4,8.3-7.2c.3-.2.6-.4.9-.6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2,0,.4,0,.8,0,0,0,0,0,.1,0,1.1-.1,2.9-.4,4.4-.7h0c.2,0,.4-.1.6-.2v-3c0,0,3.5-1.7,9.9-4.2,0,0,1.3,3.4,3.7,5.7.5.5,1.1,1,1.7,1.3,0,0,1,.2,2.5.6Z"
					/>
					<path
						className="light"
						fill={colors.paper.lighter}
						d="M30.5,19.7c3.7-3.2,7.8-6.5,7.8-6.5l-.2.5,1.1,1.1-.4.5s-1-.3-1.5-.4c-.6,0,.6.9.6.9,0,0-4.4,3.8-5.6,4.9-1.2,1.1-2.1,2.8-2.1,2.8l-7.5,1.2s-2.8-1.1-6.1-2.6h.1c0,0-.1-1-.2-1.8,5.3,2.1,9.7,3.3,9.7,3.3,1.1-1.2,2.7-2.6,4.3-4h0ZM31.2,7.7c-.6-.4-1.2-.8-1.7-1.3-2.4-2.4-3.7-5.7-3.7-5.7-6.3,2.4-9.8,4.2-9.8,4.2v3c-.3,0-.5.1-.7.2h0c-1.4.3-3.3.6-4.4.7,0,0,0,0-.1,0-.4,0-.7,0-.8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0-.3.2-.6.4-.9.6C4.7,12.3.5,16.7.5,16.7l5.8.6s0,0,0,0h0s.1,0,.1,0h0c1.8,1.2,5.1,2.8,8.2,4.3h0s0,0,0,0c0-.2.4-.8.7-1.3-.1,0-.2,0-.4-.1h0c-2.7-1.1-5.3-2.2-7.9-3.6-.2-.1-.4-.2-.6-.3,0,0,0,0,0,0h0s-3.3-.5-3.3-.5l4.9-4.3h0s0,0,0,0l2.1-1.8,5.7-1.2.3-2.9,8.2-3.2,4.2,4.6,1,1.1s1,.4,2.5.8c1.4.4,3.4.9,5.4,1.1h0s-.1-.6-.1-.6c-1.5-.4-2.9-.7-3.9-.9-1.6-.4-2.5-.6-2.5-.6Z"
					/>
					<path
						className="dark"
						fill={colors.paper.dark}
						d="M37.9,10.4l-.8.3v-.4s.8.1.8.1ZM36.9,14.9v.3c.7,0,1.3.3,1.3.3h.6c-.8-.5-1.9-.6-1.9-.6ZM15,21.6s0,0,0,0c-3.1-1.4-6.4-2.9-8.3-4.2-4.2-2.7-.3,0-.3,0,0,0-3.1-.6-5.8-.6l.6.3s3.1.2,5.2.6c0,0,3.7,2.2,8,4.2h0s.6-.2.6-.2h0ZM16.1,22.6c2.3,1,4.6,1.9,6.5,2.3l.3-.2s-2.8-1.1-6.2-2.5l-.6.3ZM30.1,23.7l-5.2-1.6c-1.8,1.2-2.3,2.8-2.3,2.8l7.5-1.2Z"
					/>
					<path
						className="lighter"
						fill={colors.paper.lighter}
						d="M24.9,22h.7c0,0,1.9.8,4.7,1.3.1,0-.1.3-.1.3l-5.2-1.6Z"
					/>
					<path
						className="lighing"
						fill={colors.base.white}
						fillOpacity="0.1"
						d="M6.3,17.3l2.5-7.9c-3.1,1.8-8.3,7.2-8.3,7.2l.6.3s2.2,0,5.2.6c.1,0,0-.2,0-.2Z"
					/>
					<path
						className="spot"
						fill={colors.paper.icon}
						fillOpacity="0.1"
						d="M18.3,11.6c-.2,1.1-.5,3.4,2,2.2,2.5-1.1,3.5-2,2.9-2.7-.6-.7-4.8-.4-4.9.5Z"
					/>
					<path
						className="x"
						fill={colors.paper.icon}
						d="M23.3,10.8c-.2.1-.5.2-.7.3-.5.2-1,.4-1.6.5-.3,0-.6.1-.9.2,0,0,0,0,0,0,0,0,0-.2-.1-.2,0-.2-.1-.3-.2-.5,0-.2,0-.3,0-.5,0,.2,0,.3,0,.5,0,.2,0,.3,0,.5,0,0,0,.2,0,.2-.2,0-.4,0-.6,0-.6,0-1.2,0-1.8,0h0s0,0,0,0c-.2,0-.4.1-.4.2,0,.1.2.2.4.2.7,0,1.4,0,2-.2.2,0,.4,0,.6-.1,0,.1.1.3.2.4.2.3.4.6.7.9.1.1.3.3.4.4,0,0,.1.1.2.2,0,0,.2.1.2.2,0,0,0,0,0,0,.1,0,.4.1.6,0,.2,0,.2-.2,0-.3h0c0,0-.2-.1-.3-.2,0,0-.2-.1-.3-.2-.2-.1-.3-.3-.5-.4-.3-.3-.6-.6-.8-.8-.1-.1-.2-.3-.3-.4,0,0,0,0,0,0,.3,0,.6-.2.9-.2.6-.2,1.1-.4,1.5-.6.2-.1.4-.2.6-.4.2-.1.4-.3.5-.4-.2.1-.4.3-.6.4Z"
					/>
					<path
						className="shadow"
						fill={colors.base.black}
						fillOpacity="0.05"
						d="M27.9,8.4c-3.5-1.6-21.6,1.8-18.8,4.7,2.8,2.9,18,13.4,20.9,2.3,1.3-5.1-1-6.5-2.1-7Z"
					/>
					<path
						className="darker"
						fill={colors.paper.darker}
						d="M15.9,7.8l-.6.2.3-2.4.4-.8v3ZM16.7,22.2l-.4-2.8-.3.4.2,2.7.6-.3ZM32.9,19.7l4-3.5-.7-.6c-1.2.9-5,4-5,4h1.7Z"
					/>
					<path
						className="stroke"
						strokeWidth="1"
						fill="transparent"
						d="M38.1,13.8l.2-.5.4-1.2c-.9-.9-1.5-1.2-1.5-1.2v-.2s0-.4,0-.4v.4s.9-.3.9-.3v-.6c0,0-.2-.6-.2-.6-1.5-.4-2.9-.7-3.9-.9-1.6-.4-2.5-.6-2.5-.6-.6-.4-1.2-.8-1.7-1.3-2.4-2.4-3.7-5.7-3.7-5.7-6.3,2.4-9.8,4.2-9.8,4.2l-.4.8-.3,2.4h0c-1.4.3-3.3.6-4.4.7,0,0,0,0-.1,0-.4,0-.7,0-.8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0-.3.2-.6.4-.9.6h0c-1.7,1-3.9,3-5.7,4.7-1.6,1.5-2.6,2.6-2.6,2.6l.6.3s.8,0,1.9.2c.9,0,2,.2,3.3.4,0,0,3.7,2.2,8,4.2h0s.6-.2.6-.2h0s0,0,0,0c0-.2.4-.8.7-1.3,0,0,0,0,0,0,0-.1.1-.3.2-.4.2-.3.3-.5.3-.4,0,0,.1.5.2,1,0,0,0,0,0,0,0,0,0,.2,0,.3,0,0,0,.1,0,.2,0,0,0,0,0,0,0,0,0,.1,0,.2,0,0,0,0,0,0,0,0,0,.1,0,.2,0,0,0,0,0,0,0,.3,0,.5,0,.6,0,0,0,0,0,0h0s-.4-2.8-.4-2.8l-.3.4.2,2.7c2.3,1,4.6,1.9,6.5,2.3l7.5-1.2s.3-.2.1-.3c0,0,0,0,0,0,0-.1.1-.2.2-.4,0,0,0,0,0,0,0-.1.1-.2.2-.4,0,0,0-.1.1-.2,0-.1.2-.2.3-.4,0,0,0-.1.1-.2,0-.1.2-.3.3-.4,0,0,0-.1.1-.2.2-.2.3-.3.5-.5,0,0,.2-.1.3-.2,0,0,0,0,0,0,0,0,0,0,0,0,.1-.1.3-.2.4-.4,0,0,0,0,0,0,0,0,.2-.1.3-.2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.1-.1.2-.2,0,0,0,0,0,0,.1-.1.3-.2.4-.3,0,0,0,0,0,0,0,0,.1-.1.2-.2,0,0,.1,0,.2-.1,0,0,.2-.2.3-.2.1,0,.2-.2.3-.3,0,0,0,0,0,0,.3-.2.5-.5.8-.7,0,0,0,0,0,0,0,0,0,0,.1-.1,0,0,.2-.1.2-.2,0,0,0,0,0,0,.5-.4.8-.7,1.1-1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.1,0,.2-.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0-.1-.1,0,0,0,0,0,0,0,0,0,0-.1-.1,0,0,0,0,0,0,0,0,0,0-.1-.1,0,0,0,0,0,0,0,0,0,0,0,0,.6,0,1,.3,1,.3h.6c0,0,.4-.6.4-.6l-1.1-1.1Z"
					/>
				</svg>
			</MapRoot>
		</Link>
	);
};
